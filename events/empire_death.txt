namespace = toe

#Kill empire that is too small

character_event = {
	id = toe.1150
	hide_window = yes
	
	trigger = {
		NOT = { realm_size = 45 } #15 counties
		real_tier = EMPEROR
		is_nomadic = no
		is_tribal = no
		war = no
		NOT = { is_offmap_governor = offmap_china }
	}
	
	mean_time_to_happen = { days = 1 }
	
	immediate = {	
		primary_title = {
            create_title = {
                tier = KING
                landless = no
                temporary = no
                custom_created = yes
                culture = ROOT
				short_name = yes
                holder = ROOT
                base_title = THIS
                copy_title_laws = yes
				ruler = "Emperor"
				ruler_female = "Empress"
            }
			new_title = {
				copy_title_history = PREV 
				save_event_target_as = new_king_title
			}
        }
		any_vassal = {
			limit = {
				NOT = { tier = KING }
			}
			set_character_flag = toe_imperial_vassal
		}
		set_character_flag = toe_imperial_emperor
		character_event = { id = toe.1151 days = 1 }
	}
}

character_event = {
	id = toe.1151
	desc = EVTDESC_toe.1151
	picture = "GFX_evt_end_of_days"
	
	is_triggered_only = yes
	
	immediate = {
		primary_title = {
			any_claimant = {
				limit = {
					has_claim = THIS
				}
				remove_claim = THIS
				add_pressed_claim = event_target:new_king_title
			}
			any_claimant = {
				limit = {
					has_weak_claim = THIS
				}
				remove_claim = THIS
				add_weak_pressed_claim = event_target:new_king_title
			}
			destroy_landed_title = THIS
		}
		event_target:new_king_title = {
			set_title_flag = vestigial_empire
		}
		any_playable_ruler = {
			limit = { has_character_flag = toe_imperial_vassal }
			character_event = { id = toe.1152 days = 1 }
		}
	}
	
	option = {
		name = EVTOPTA_toe.1151
	}
}

character_event = {
	id = toe.1152
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {	
		FROM = {
			set_defacto_liege = ROOT
			clr_character_flag = toe_imperial_vassal
		}
	}
}

#Remove vestigial empire if you have a real one

character_event = {
	id = toe.1153
	desc = EVTDESC_toe.1153
	picture = "GFX_evt_coronation"
	
	trigger = {
		real_tier = EMPEROR
		is_nomadic = no
		is_tribal = no
		war = no
		any_demesne_title = {
			has_title_flag = vestigial_empire
		}
	}
	
	mean_time_to_happen = { days = 1 }
	
	immediate = {		
		any_demesne_title = {
			limit = {
				has_title_flag = vestigial_empire
			}
			destroy_landed_title = THIS
		}
	}
	
	option = {
		name = EVTOPTA_toe.1153
	}
}