namespace = toe

#Actual type decision
character_event = {
	id = toe.1800
	desc = EVTDESC_toe.1800
	picture = "GFX_evt_recieve_letter"
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_toe.1800 #Diplomacy
		character_event = { id = toe.1802 }
	}
	option = {
		name = EVTOPTB_toe.1800 #Martial
		character_event = { id = toe.1803 }
	}
	option = {
		name = EVTOPTC_toe.1800 #Stewardship
		character_event = { id = toe.1804 }
	}
	option = {
		name = EVTOPTD_toe.1800 #Or...
		character_event = { id = toe.1801 }
	}
}

#Actual type decision(more)
character_event = {
	id = toe.1801
	desc = EVTDESC_toe.1800
	picture = "GFX_evt_recieve_letter"
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_toe.1801 #Intrigue
		character_event = { id = toe.1805 }
	}
	option = {
		name = EVTOPTB_toe.1801 #Learning
		character_event = { id = toe.1806 }
	}
	option = {
		name = EVTOPTD_toe.1800 #Or...
		character_event = { id = toe.1800 }
	}
}


#Diplomacy
character_event = {
	id = toe.1802
	desc = EVTDESC_toe.1802
	picture = "GFX_evt_throne_room"
	is_triggered_only = yes
	
	immediate = {
		create_random_diplomat = {
			random_traits = no
			dynasty = NONE
			female = no
			age = 22
			religion = ROOT
			attributes = {
				diplomacy = 6
			}
			trait = eunuch
			trait = diligent
			trait = temperate
			trait = humble
		}
		random_list = {
			10 = {
				new_character = {
					culture = bedouin_arabic
				}
			}
			10 = {
				new_character = {
					culture = greek
				}
			}
			10 = {
				new_character = {
					culture = ethiopian
				}
			}
			10 = {
				new_character = {
					culture = manden
				}
			}
			10000 = {
				modifier = {
					factor = 0
					NOT = { has_character_flag = eunuch_called_legal }
				}
				new_character = {
					culture = ROOT
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_toe.1802 
	}
}

#Martial
character_event = {
	id = toe.1803
	desc = EVTDESC_toe.1802
	picture = "GFX_evt_throne_room"
	is_triggered_only = yes
	
	immediate = {
		create_random_soldier = {
			random_traits = no
			dynasty = NONE
			female = no
			age = 22
			religion = ROOT
			attributes = {
				martial = 6
			}
			trait = eunuch
			trait = diligent
			trait = temperate
			trait = humble
		}
		random_list = {
			10 = {
				new_character = {
					culture = bedouin_arabic
				}
			}
			10 = {
				new_character = {
					culture = greek
				}
			}
			10 = {
				new_character = {
					culture = ethiopian
				}
			}
			10 = {
				new_character = {
					culture = manden
				}
			}
			10000 = {
				modifier = {
					factor = 0
					NOT = { has_character_flag = eunuch_called_legal }
				}
				new_character = {
					culture = ROOT
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_toe.1802
	}
}

#Stew
character_event = {
	id = toe.1804
	desc = EVTDESC_toe.1802
	picture = "GFX_evt_throne_room"
	is_triggered_only = yes
	
	immediate = {
		create_random_steward = {
			random_traits = no
			dynasty = NONE
			female = no
			age = 22
			religion = ROOT
			attributes = {
				stewardship = 6
			}
			trait = eunuch
			trait = diligent
			trait = temperate
			trait = humble
		}
		random_list = {
			10 = {
				new_character = {
					culture = bedouin_arabic
				}
			}
			10 = {
				new_character = {
					culture = greek
				}
			}
			10 = {
				new_character = {
					culture = ethiopian
				}
			}
			10 = {
				new_character = {
					culture = manden
				}
			}
			10000 = {
				modifier = {
					factor = 0
					NOT = { has_character_flag = eunuch_called_legal }
				}
				new_character = {
					culture = ROOT
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_toe.1802
	}
}

#Intrigue
character_event = {
	id = toe.1805
	desc = EVTDESC_toe.1802
	picture = "GFX_evt_throne_room"
	is_triggered_only = yes
	
	immediate = {
		create_random_intriguer = {
			random_traits = no
			dynasty = NONE
			female = no
			age = 22
			religion = ROOT
			attributes = {
				intrigue = 6
			}
			trait = eunuch
			trait = diligent
			trait = temperate
			trait = humble
		}
		random_list = {
			10 = {
				new_character = {
					culture = bedouin_arabic
				}
			}
			10 = {
				new_character = {
					culture = greek
				}
			}
			10 = {
				new_character = {
					culture = ethiopian
				}
			}
			10 = {
				new_character = {
					culture = manden
				}
			}
			10000 = {
				modifier = {
					factor = 0
					NOT = { has_character_flag = eunuch_called_legal }
				}
				new_character = {
					culture = ROOT
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_toe.1802
	}
}

#Learning
character_event = {
	id = toe.1806
	desc = EVTDESC_toe.1802
	picture = "GFX_evt_throne_room"
	is_triggered_only = yes
	
	immediate = {
		create_random_priest = {
			random_traits = no
			dynasty = NONE
			female = no
			age = 22
			religion = ROOT
			attributes = {
				learning = 6
			}
			trait = eunuch
			trait = diligent
			trait = temperate
			trait = humble
		}
		random_list = {
			10 = {
				new_character = {
					culture = bedouin_arabic
				}
			}
			10 = {
				new_character = {
					culture = greek
				}
			}
			10 = {
				new_character = {
					culture = ethiopian
				}
			}
			10 = {
				new_character = {
					culture = manden
				}
			}
			10000 = {
				modifier = {
					factor = 0
					NOT = { has_character_flag = eunuch_called_legal }
				}
				new_character = {
					culture = ROOT
				}
			}
		}
	}
	
	option = {
		name = EVTOPTA_toe.1802
	}
}

#Set up historical eunuch-havers
character_event = {
	id = toe.1807
	hide_window = yes
	is_triggered_only = yes
	trigger = {
		primary_title = {
			NOT = { has_title_flag = eunuchs_legal }
		}
		OR = {
			has_landed_title = e_byzantium
			has_landed_title = e_arabia
			has_landed_title = e_tibet
			has_landed_title = e_china_west_governor
		}
	}
	immediate = {
		primary_title = {
			set_title_flag = eunuchs_legal
		}
	}
}

#Inform of legal eunuchs
character_event = {
	id = toe.1808
	desc = EVTDESC_toe.1808
	picture = "GFX_evt_chinese_bureaucrat"
	is_triggered_only = yes
	
	option = {
		trigger = {
			character = FROM
		}
		name = EVTOPTA_toe.1808
	}
	option = {
		trigger = {
			NOT = { character = FROM }
		}
		name = EVTOPTB_toe.1808
	}
}


#Make child eunuch
character_event = {
	id = toe.1809
	desc = EVTDESC_toe.1809
	picture = "GFX_evt_chinese_bureaucrat"

	trigger	= {
		num_of_children = 3 
		any_close_relative = { ai = no }
		any_child = {
			is_heir = no
			is_female = no
			NOT = { age = 5 }
			NOT = {
				trait = court_eunuch
			}
			NOT = { has_character_flag = eunuch_choice_made }
		}
		top_liege = {
			primary_title = {
				has_title_flag = eunuchs_legal
			}
		}
	}
	mean_time_to_happen = {
		months = 36
	}

	immediate = {
		random_child = {
			limit = {
				is_heir = no
				is_female = no
				is_alive = yes
				NOT = {
					trait = court_eunuch
				}
				NOT = { age = 5 }
			}
			save_event_target_as = target_child
		}
	}
	option = {
		ai_chance = {
			factor = 10
			modifier = {
				factor = 1.25
				OR = {
					trait = proud
					trait = kind
					trait = content
					trait = zealous
				}
			}
			modifier = {
				factor = 1.25
				NOT = { num_of_children = 3 }
			}
			modifier = {
				factor = 1.5
				event_target:target_child = {
					OR = {
						trait = attractive
						trait = strong
					}
				}
			}
		}
		name = EVTOPTA_toe.1809
		event_target:target_child = { 
			set_character_flag = eunuch_choice_made
		}
	}
	option = {
		ai_chance = {
			factor = 20
			modifier = {
				factor = 1.25
				OR = {
					trait = lunatic
					trait = impaler
					trait = greedy
					trait = envious
					trait = ambitious
					trait = arbitrary
					trait = cynical
					trait = cruel
				}
			}
			modifier = {
				factor = 1.5
				event_target:target_child = {
					OR = {
						trait = ugly
						trait = weak
						trait = dwarf
						trait = hunchback
						trait = bastard
						trait = legit_bastard
					}
				}
			}
			modifier = {
				factor = 1.25
				num_of_children = 5
			}
			modifier = {
				factor = 1.25
				num_of_children = 6
			}
		}
		name = EVTOPTB_toe.1809
		event_target:target_child = { 
			opinion = {
				who = ROOT
				modifier = opinion_castrated_me_education
				years = 20
			}
			random_list = {
				50 = { 
					add_trait = severely_injured
					resolve_severely_injured_effect = yes
				}
				25 = { 
					add_trait = severely_injured
					add_trait = infection
					resolve_severely_injured_effect = yes
				}
				25 = { 
				}
			}
			add_trait = court_eunuch
			add_trait = eunuch
		}
	}
}